#!/usr/bin/env python

import argparse
import json
import sys

from   supdoc.inspector import DocSource
from   supdoc.modules import find_submodules
from   supdoc.path import Path

#-------------------------------------------------------------------------------

parser = argparse.ArgumentParser()
parser.add_argument(
    "modnames", metavar="MODNAME", nargs="*",
    help="fully-qualified module name")
args = parser.parse_args()

modnames = sorted({ n for m in args.modnames for n in find_submodules(m) })
docsrc = DocSource()
objdoc = {
    "modules": {
        m["name"]: m
        for n in modnames
        for m in (docsrc.get(Path(n, None)), )  # FIXME: :=
    }
}
json.dump(objdoc, sys.stdout, indent=1, sort_keys=True)

